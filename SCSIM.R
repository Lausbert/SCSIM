###Produktionsaufträge###
#========================
vert <- c(250,250,150)

prod <- matrix(c(3, 150,
                 2, 250,
                 1, 250,
                 26,650,
                 31, 50,
                 20, 50,
                 15,50,
                 12,50,
                 9,50,
                 6,50,
                 30,50,
                 29,50,
                 19,150,
                 14, 150,
                 11, 250,
                 8,  150,
                 5,  150,
                 18,  250,
                 13,  150,
                 10,  150,
                 7,  150,
                 4,  250,
                 17,  650,
                 54,  250,
                 29,  0,
                 49,  250,
                 30,  0,
                 55,  250,
                 50,  250,
                 56,  150,
                 31,  0,
                 51,  250,
                 55,  0,
                 7,  100,
                 8,  100,
                 5,  100,
                 29,  0,
                 19,  100,
                 14,  0,
                 11,  0,
                 13,  0,
                 56,  0,
                 56,  100,
                 29,  100,
                 30, 100,
                 31,  100,
                 12,  0,
                 20,  0,
                 9,  100,
                 6,  100,
                 19,  0,
                 4,  0,
                 20,  100,
                 14,  100,
                 15,  100,
                 12,  100,
                 10,  100,
                 13,  100,
                 26,  0,
                 16,  650),60,2,byrow=TRUE)

über <- matrix(c(240,200,240,480,0,190,630,480,600,605,480,480,40,0,240),1,15)

auftre <- matrix(c(0, 50, 56, 0, 0, 0, 0, 0, 15, 0, 5, 0, 0, 16, 17,
                   0, 0, 31, 0, 0, 0, 0, 0, 12, 0, 9, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 10, 0, 6, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 13, 0, 4, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),30,15,byrow=TRUE)

auftrm <- matrix(c(0, 20, 70, 0, 0, 0, 0, 0, 10, 0, 10, 0, 0, 400, 150,
                   0, 0, 100, 0, 0, 0, 0, 0, 100, 0, 100, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 100, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 100, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),30,15,byrow=TRUE)

zust <- matrix(c(0, 50, 56, 0, 0, 0, 0, 0, 15, 0, 5, 0, 0, 16, 17,
                 0, 30, 20, 0, 0, 0, 0, 0, 15, 0, 30, 0, 0, 20, 15,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1,
                 0, 50, 56, 0, 0, 0, 0, 0, 15, 0, 5, 0, 0, 16, 17,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),7,15,byrow=TRUE)

###Anfangsbestand###
#===================

lager <- matrix(c( 1,50,164.33,
                   2,50,169.84,
                   3,50,171.53,
                   4,10,40.77,
                   5,90,40.35,
                   6,0,42.24,
                   7,100,35.21,
                   8,100,33.99,
                   9,0,36.57,
                   10,10,13.11,
                   11,100,14.3,
                   12,0,14.43,
                   13,0,13.88,
                   14,100,14.31,
                   15,90,15.18,
                   16,60,7.58,
                   17,310,7.8,
                   18,100,14.18,
                   19,100,15.59,
                   20,100,17.57,
                   21,650,4.62,
                   22,580,6.11,
                   23,300,6.02,
                   24,8670,0.14,
                   25,3520,0.07,
                   26,100,10.89,
                   27,1960,0.14,
                   28,7700,1.11,
                   29,100,71.88,
                   30,200,132.38,
                   31,0,150.51,
                   32,5900,0.71,
                   33,500,23.5,
                   34,26700,0.11,
                   35,3600,1,
                   36,1250,7.66,
                   37,1410,1.44,
                   38,1690,1.48,
                   39,2650,1.47,
                   40,1840,2.36,
                   41,1440,0.11,
                   42,3230,0.12,
                   43,1240,5.06,
                   44,3190,0.47,
                   45,1590,0.11,
                   46,1190,0.15,
                   47,1070,3.33,
                   48,2950,1.5,
                   49,110,67.58,
                   50,80,125.73,
                   51,100,144.7,
                   52,1130,20.13,
                   53,37200,0.09,
                   54,100,70.32,
                   55,160,129.14,
                   56,30,151.02,
                   57,1050,19.93,
                   58,19600,0.09,
                   59,2950,0.17,
                  60, 0, 0,
                  61, 0, 0,
                  62, 0, 0,
                  63, 0, 0,
                  64, 0, 0,
                  65, 0, 0,
                  66, 100, 0,
                  67, 0, 0,
                  68, 0, 0,
                  69, 0, 0,
                  70, 0, 0,
                  71, 0, 0,
                  72, 0, 0,
                  73, 0, 0,
                  74, 0, 0,
                  75, 0, 0,
                  76, 0, 0,
                  77, 0, 0,
                  78, 0, 0,
                  79, 0, 0,
                  80, 100, 0,
                  81, 100, 0,
                  82, 0, 0,
                  83, 100, 0,
                  84, 0, 0,
                  85, 0, 0,
                  86, 0, 0,
                  87, 0, 0,
                  88, 0, 0,
                  89, 0, 0,
                  90, 0, 0,
                  91, 0, 0,
                  92, 0, 0,
                  93, 100, 0,
                  94, 0, 0,
                  95, 100, 0,
                  96, 390, 0,
                  97, 0, 0,
                  98, 0, 0,
                  99, 0, 0,
                  100, 0, 0),100,3,byrow=TRUE)

auftr <- array(0,dim=c(30,15,2))
auftr[,,1] <- auftre
auftr[,,2] <- auftrm

###Simulation###
#===============

simulation <- function(prod,lager,über,auftr,zust){
  
  prod <- nullen(prod)
  auftr <- auft(prod,auftr)
  beleg <- matrix(0,(480+max(über)),15)
  beleg1 <- matrix(0,(480+max(über)),15)
  beleg2 <- matrix(0,(480+max(über)),15)
  beleg3 <- matrix(0,(480+max(über)),15)
  beleg4 <- matrix(0,(480+max(über)),15)
  beleg5 <- matrix(0,(480+max(über)),15)
  
  bearz <- matrix(c(0,  0,  0,	6,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	7,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	7,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	4,	3,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	4,	3,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	4,	3,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	4,	3,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	4,	3,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	4,	3,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	2,	1,	3,	0,	0,	3,	2,	0,	0,
                  0,	0,	0,	0,	0,	0,	2,	2,	3,	0,	0,	3,	2,	0,	0,
                  0,	0,	0,	0,	0,	0,	2,	2,	3,	0,	0,	3,	2,	0,	0,
                  0,	0,	0,	0,	0,	0,	2,	1,	3,	0,	0,	3,	2,	0,	0,
                  0,	0,	0,	0,	0,	0,	2,	2,	3,	0,	0,	3,	2,	0,	0,
                  0,	0,	0,	0,	0,	0,	2,	2,	3,	0,	0,	3,	2,	0,	0,
                  0,	0,	0,	0,	0,	2,	0,	0,	0,	0,	0,	0,	0,	3,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	3,
                  0,	0,	0,	0,	0,	3,	2,	3,	2,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	3,	2,	3,	2,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	3,	2,	3,	2,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	2,	0,	0,	0,	0,	0,	0,	0,	3,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  6,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	5,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	6,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  6,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	5,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	5,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  6,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	5,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	6,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0),56,15,byrow=TRUE)
                  
                    
  ruestz <- matrix(c(0,  0,  0,  30,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	20,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	30,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	20,	10,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	20,	10,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	20,	20,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	20,	20,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	20,	20,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	20,	20,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	20,	15,	15,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	20,	15,	15,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	20,	15,	15,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	20,	15,	15,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	20,	15,	15,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	20,	15,	15,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	15,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	15,
                  0,	0,	0,	0,	0,	15,	20,	20,	15,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	15,	20,	25,	20,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	15,	20,	20,	15,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	30,	0,	0,	0,	0,	0,	0,	0,	15,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  20,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	20,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	20,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  20,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	30,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	20,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,  0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  20,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	30,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                  0,	0,	20,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0),56,15,byrow=TRUE)
  
  zuord <- matrix(c(0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,81,4,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,82,5,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,83,6,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,78,7,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,79,8,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,80,9,0,0,0,0,
                    0,0,0,0,0,0,93,90,10,0,0,87,84,0,0,
                    0,0,0,0,0,0,94,91,11,0,0,88,85,0,0,
                    0,0,0,0,0,0,95,92,12,0,0,89,86,0,0,
                    0,0,0,0,0,0,66,63,13,0,0,60,98,0,0,
                    0,0,0,0,0,0,67,64,14,0,0,61,99,0,0,
                    0,0,0,0,0,0,68,65,15,0,0,62,100,0,0,
                    0,0,0,0,0,96,0,0,0,0,0,0,0,16,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,
                    0,0,0,0,0,69,75,72,18,0,0,0,0,0,0,
                    0,0,0,0,0,70,76,73,19,0,0,0,0,0,0,
                    0,0,0,0,0,71,77,74,20,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,97,0,0,0,0,0,0,0,26,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    29,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,50,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,51,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,55,0,0,0,0,0,0,0,0,0,0,0,0,0,
                    0,0,56,0,0,0,0,0,0,0,0,0,0,0,0),56,15,byrow=TRUE)
  
  mat <- structure(c(21, 22, 23, 35, 35, 35, 35, 35, 35, 32, 32, 32, 32, 
                     32, 32, 24, 43, 32, 32, 32, 0, 0, 0, 0, 0, 47, 0, 0, 9, 6, 16, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 4, 16, 
                     0, 0, 8, 5, 16, 0, 0, 0, 98, 99, 100, 60, 61, 62, 63, 64, 65, 
                     28, 28, 28, 69, 70, 71, 59, 59, 59, 52, 57, 33, 52, 57, 33, 39, 
                     39, 39, 84, 85, 86, 87, 88, 89, 90, 91, 92, 28, 44, 39, 39, 39, 
                     24, 24, 24, 36, 36, 36, 37, 37, 37, 93, 94, 95, 66, 67, 68, 40, 
                     44, 75, 76, 77, 0, 0, 0, 0, 0, 97, 0, 0, 15, 12, 17, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 10, 17, 0, 0, 14, 
                     11, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     72, 73, 74, 53, 58, 34, 53, 58, 34, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 48, 0, 0, 0, 26, 26, 26, 81, 82, 83, 38, 38, 38, 
                     0, 0, 0, 0, 0, 0, 41, 45, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 
                     24, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18, 
                     24, 24, 0, 0, 19, 24, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 27, 27, 27, 0, 0, 0, 78, 79, 
                     80, 0, 0, 0, 0, 0, 0, 42, 46, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     24, 25, 27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     24, 25, 27, 0, 0, 24, 25, 27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 51, 56, 31, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     25, 29, 30, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     25, 49, 50, 0, 0, 25, 54, 55, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 2, 2, 2, 2, 2, 
                     1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 
                     1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 
                     0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 4, 5, 1, 
                     1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
                     1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
                     1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 
                     36, 36, 36, 36, 36, 36, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     2, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 1, 0, 0, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 1, 0, 0, 1, 2, 1, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 
                     1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 2, 1, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 2, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 2, 2, 1, 0, 0, 2, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     0, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     2, 1, 1, 0, 0, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0), .Dim = c(100L, 5L, 2L))
  for(t in 1:5){
    #Lagerzugänge unter der Woche
    if(t==2){
      lager[43,2] <- lager[43,2] + 820
      lager[58,2] <- lager[58,2] + 22000
      lager[27,2] <- lager[27,2] + 1000
      lager[25,2] <- lager[25,2] + 2100
    }
    if(t==3){
      lager[47,2] <- lager[47,2] + 550
      lager[44,2] <- lager[44,2] + 1400
      lager[36,2] <- lager[36,2] + 400
    }
    if(t==4){
      lager[24,2] <- lager[24,2] + 3500
    }
    if(t==5){
      lager[35,2] <- lager[35,2] + 4500
      lager[39,2] <- lager[39,2] + 400
      lager[34,2] <- lager[34,2] + 5000
      lager[37,2] <- lager[37,2] + 200
    }
    for(i in 1:(480+max(über))){
      print((i+(t-1)*(480+max(über)))/(5*(480+max(über))))
      bear     <- bear(auftr,zust,lager,i,zuord,bearz,ruestz,mat,beleg,über)
      auftr     <- array(c(matrix(unlist(bear[1]))),dim=c(30,15,2))
      zust     <- matrix((c(unlist(bear[2]))),7,15)
      lager    <- matrix((c(unlist(bear[3]))),100,3)
      beleg    <- matrix((c(unlist(bear[4]))),(480+max(über)),15)
  }
    if(t==1){beleg1 <- beleg
            beleg <- matrix(0,(480+max(über)),15)}
    if(t==2){beleg2 <- beleg
            beleg <- matrix(0,(480+max(über)),15)}
    if(t==3){beleg3 <- beleg
            beleg <- matrix(0,(480+max(über)),15)}
    if(t==4){beleg4 <- beleg
            beleg <- matrix(0,(480+max(über)),15)}
    if(t==5){beleg5 <- beleg
            beleg <- matrix(0,(480+max(über)),15)}
  }
  erg. <-list(auftr,zust,lager,beleg1,beleg2,beleg3,beleg4,beleg5,über)
  return(erg.)
}
  
#Nullen eliminieren
#------------------

nullen <- function(prod){
  prod.hilf <- matrix(NA,(dim(prod)[1]-sum(prod==0)),2)
  if(sum(prod)==0){return(prod)}
  j <- 0
  
  for(i in 1:(length(prod)/2)){
    if(prod[i,2]==0){j <- j+1
                     next}
    prod.hilf[i-j,] <- prod[i,]
  }
  
  prod <- prod.hilf
  return(prod)
}

#Aufträge für einzelne Arbeitsplätze
#-----------------------------------

auft <- function(prod,auftr){
  if(sum(prod)==0){return(auftr)}
  #1.Arbeitsplatz
  j <- 0
  for(i in 1:(length(prod)/2)){
    if(prod[i,1]==49 || prod[i,1]==54 || prod[i,1]==29){
      while(auftr[i-j,1,1]!=0){j <-  j-1}
      auftr[i-j,1,1] <- prod[i,1]
      auftr[i-j,1,2] <- prod[i,2]
      next
    }
    j <- j+1
  }
  
  #2.Arbeitsplatz
  j <- 0
  for(i in 1:(length(prod)/2)){
    if(prod[i,1]==50 || prod[i,1]==55 || prod[i,1]==30){
      while(auftr[i-j,2,1]!=0){j <-  j-1}
      auftr[i-j,2,1] <- prod[i,1]
      auftr[i-j,2,2] <- prod[i,2]
      next
    }
    j <- j+1
  }
  
  #3.Arbeitsplatz
  j <- 0
  for(i in 1:(length(prod)/2)){
    if(prod[i,1]==51 || prod[i,1]==56 || prod[i,1]==31){
      while(auftr[i-j,3,1]!=0){j <-  j-1}
      auftr[i-j,3,1] <- prod[i,1]
      auftr[i-j,3,2] <- prod[i,2]
      next
    }
    j <- j+1
  }
  
  #4.Arbeitsplatz
  j <- 0
  for(i in 1:(length(prod)/2)){
    if(prod[i,1]==1 || prod[i,1]==2 || prod[i,1]==3){
      while(auftr[i-j,4,1]!=0){j <-  j-1}
      auftr[i-j,4,1] <- prod[i,1]
      auftr[i-j,4,2] <- prod[i,2]
      next
    }
    j <- j+1
  }
  
  #6.Arbeitsplatz
  j <- 0
  for(i in 1:(length(prod)/2)){
    if(prod[i,1]==18 || prod[i,1]==19 || prod[i,1]==20 || prod[i,1]==16){
      while(auftr[i-j,6,1]!=0){j <-  j-1}
      auftr[i-j,6,1] <- prod[i,1]
      auftr[i-j,6,2] <- prod[i,2]
      next
    }
    j <- j+1
  }
  
  #7.Arbeitsplatz
  j <- 0
  for(i in 1:(length(prod)/2)){
    if(prod[i,1]==13 || prod[i,1]==14 || prod[i,1]==15 || prod[i,1]==18 || prod[i,1]==19 || prod[i,1]==20 || prod[i,1]==10 || prod[i,1]==11 || prod[i,1]==12|| prod[i,1]==26){
      while(auftr[i-j,7,1]!=0){j <-  j-1}
      auftr[i-j,7,1] <- prod[i,1]
      auftr[i-j,7,2] <- prod[i,2]
      next
    }
    j <- j+1
  }
  
  #8.Arbeitsplatz
  j <- 0
  for(i in 1:(length(prod)/2)){
    if(prod[i,1]==13 || prod[i,1]==14 || prod[i,1]==15 || prod[i,1]==18 || prod[i,1]==19 || prod[i,1]==20 || prod[i,1]==10 || prod[i,1]==11 || prod[i,1]==12){
      while(auftr[i-j,8,1]!=0){j <-  j-1}
      auftr[i-j,8,1] <- prod[i,1]
      auftr[i-j,8,2] <- prod[i,2]
      next
    }
    j <- j+1
  }

  #9.Arbeitsplatz
  j <- 0
  for(i in 1:(length(prod)/2)){
    if(prod[i,1]==13 || prod[i,1]==14 || prod[i,1]==15 || prod[i,1]==18 || prod[i,1]==19 || prod[i,1]==20 || prod[i,1]==10 || prod[i,1]==11 || prod[i,1]==12){
      while(auftr[i-j,9,1]!=0){j <-  j-1}
      auftr[i-j,9,1] <- prod[i,1]
      auftr[i-j,9,2] <- prod[i,2]
      next
    }
    j <- j+1
  }
  
  #10.Arbeitsplatz
  j <- 0
  for(i in 1:(length(prod)/2)){
    if(prod[i,1]==7 || prod[i,1]==8 || prod[i,1]==9 || prod[i,1]==4 || prod[i,1]==5 || prod[i,1]==6){
      while(auftr[i-j,10,1]!=0){j <-  j-1}
      auftr[i-j,10,1] <- prod[i,1]
      auftr[i-j,10,2] <- prod[i,2]
      next
    }
    j <- j+1
  }
  
  #11.Arbeitsplatz
  j <- 0
  for(i in 1:(length(prod)/2)){
    if(prod[i,1]==7 || prod[i,1]==8 || prod[i,1]==9 || prod[i,1]==4 || prod[i,1]==5 || prod[i,1]==6){
      while(auftr[i-j,11,1]!=0){j <-  j-1}
      auftr[i-j,11,1] <- prod[i,1]
      auftr[i-j,11,2] <- prod[i,2]
      next
    }
    j <- j+1
  }
  
  #12.Arbeitsplatz
  j <- 0
  for(i in 1:(length(prod)/2)){
    if(prod[i,1]==13 || prod[i,1]==14 || prod[i,1]==15 || prod[i,1]==10 || prod[i,1]==11 || prod[i,1]==12){
      while(auftr[i-j,12,1]!=0){j <-  j-1}
      auftr[i-j,12,1] <- prod[i,1]
      auftr[i-j,12,2] <- prod[i,2]
      next
    }
    j <- j+1
  }
  
  #13.Arbeitsplatz
  j <- 0
  for(i in 1:(length(prod)/2)){
    if(prod[i,1]==13 || prod[i,1]==14 || prod[i,1]==15 || prod[i,1]==10 || prod[i,1]==11 || prod[i,1]==12){
      while(auftr[i-j,13,1]!=0){j <-  j-1}
      auftr[i-j,13,1] <- prod[i,1]
      auftr[i-j,13,2] <- prod[i,2]
      next
    }
    j <- j+1
  }
  
  #14.Arbeitsplatz
  j <- 0
  for(i in 1:(length(prod)/2)){
    if(prod[i,1]==16){
      while(auftr[i-j,14,1]!=0){j <-  j-1}
      auftr[i-j,14,1] <- prod[i,1]
      auftr[i-j,14,2] <- prod[i,2]
      next
    }
    j <- j+1
  }
  
  #15.Arbeitsplatz
  j <- 0
  for(i in 1:(length(prod)/2)){
    if(prod[i,1]==17 || prod[i,1]==26){
      while(auftr[i-j,15,1]!=0){j <-  j-1}
      auftr[i-j,15,1] <- prod[i,1]
      auftr[i-j,15,2] <- prod[i,2]
      next
    }
    j <- j+1
  }
  
  return(auftr)
}

#Bearbeitung innerhalb einer Minute
bear <- function(auftr,zust,lager,i,zuord,bearz,rüstz,mat,beleg,über){
  
  for(j in 1:15){
    if(j==1){zwischenlager <-            matrix(c( 1, 0,  156.13,
                                                 2,	0,	163.33,
                                                 3,	0,	165.08,
                                                 4,	0,	40.85,
                                                 5,	0,	39.85,
                                                 6,	0,	40.85,
                                                 7,	0,	35.85,	
                                                 8,	0,	35.85,
                                                 9,	0,	35.85,
                                                 10,	0,	12.4,
                                                 11,	0,	14.65,
                                                 12,	0,	14.65,
                                                 13,	0,	12.4,
                                                 14,	0,	14.65,
                                                 15,	0,	14.65,
                                                 16,	0,	7.02,
                                                 17,	0,	7.16,
                                                 18,	0,	13.15,
                                                 19,	0,	14.35,
                                                 20,	0,	15.55,
                                                 21,	0,	5,
                                                 22,	0,	6.5,
                                                 23,	0,	6.5,
                                                 24,	0,	0.06,
                                                 25,	0,	0.06,
                                                 26,	0,	10.5,
                                                 27,	0,	0.1,
                                                 28,	0,	1.2,
                                                 29,	0,	69.29,
                                                 30,	0,	127.53,
                                                 31,	0,	144.42,
                                                 32,	0,	0.75,
                                                 33,	0,	22,
                                                 34,	0,	0.1,
                                                 35,	0,	1,
                                                 36,	0,	8,
                                                 37,	0,	1.5,
                                                 38,	0,	1.5,
                                                 39,	0,	1.5,
                                                 40,	0,	2.5,
                                                 41,	0,	0.06,
                                                 42,	0,	0.1,
                                                 43,	0,	5,
                                                 44,	0,	0.5,
                                                 45,	0,	0.06,
                                                 46,	0,	0.1,
                                                 47,	0,	3.5,
                                                 48,	0,	1.5,
                                                 49,	0,	64.64,
                                                 50,	0,	120.63,
                                                 51,	0,	137.47,
                                                 52,	0,	22,
                                                 53,	0,	0.1,
                                                 54,	0,	68.09,
                                                 55,	0,	125.33,
                                                 56,	0,	142.67,
                                                 57,	0,	22,
                                                 58,	0,	0.1,
                                                 59,	0,	0.15,
                                                 60, 0, 0,
                                                 61, 0, 0,
                                                 62, 0, 0,
                                                 63, 0, 0,
                                                 64, 0, 0,
                                                 65, 0, 0,
                                                 66, 0, 0,
                                                 67, 0, 0,
                                                 68, 0, 0,
                                                 69, 0, 0,
                                                 70, 0, 0,
                                                 71, 0, 0,
                                                 72, 0, 0,
                                                 73, 0, 0,
                                                 74, 0, 0,
                                                 75, 0, 0,
                                                 76, 0, 0,
                                                 77, 0, 0,
                                                 78, 0, 0,
                                                 79, 0, 0,
                                                 80, 0, 0,
                                                 81, 0, 0,
                                                 82, 0, 0,
                                                 83, 0, 0,
                                                 84, 0, 0,
                                                 85, 0, 0,
                                                 86, 0, 0,
                                                 87, 0, 0,
                                                 88, 0, 0,
                                                 89, 0, 0,
                                                 90, 0, 0,
                                                 91, 0, 0,
                                                 92, 0, 0,
                                                 93, 0, 0,
                                                 94, 0, 0,
                                                 95, 0, 0,
                                                 96, 0, 0,
                                                 97, 0, 0,
                                                 98, 0, 0,
                                                 99, 0, 0,
                                                 100, 0, 0),100,3,byrow=TRUE)}
    if(j==5){next}
    if(über[j]<i-480){
      if(j==15){
        lager[1:100,2] <- (zwischenlager[1:100,2] + lager[1:100,2])
      }
      next
    }
    
    #frei
    if(zust[2,j]==0 && zust[3,j]==0){
      for(k in 1:30){
        #Alle Aufträge durch?
        if(auftr[k,j,2]==0 && auftr[k,j,1]!=0){next}
        if(auftr[k,j,1]==0){
          zust[4,j] <- zust[4,j] + 1
          break
          }
        #benötigte Teilmenge
       if(lager[mat[zuord[auftr[k,j,1],j],1,1],2] >= 10*mat[zuord[auftr[k,j,1],j],1,2]){
         if(mat[zuord[auftr[k,j,1],j],2,1]>0){if(lager[mat[zuord[auftr[k,j,1],j],2,1],2] < 10*mat[zuord[auftr[k,j,1],j],2,2]){next}}
         if(mat[zuord[auftr[k,j,1],j],3,1]>0){if(lager[mat[zuord[auftr[k,j,1],j],3,1],2] < 10*mat[zuord[auftr[k,j,1],j],3,2]){next}}
         if(mat[zuord[auftr[k,j,1],j],4,1]>0){if(lager[mat[zuord[auftr[k,j,1],j],4,1],2] < 10*mat[zuord[auftr[k,j,1],j],4,2]){next}}
         if(mat[zuord[auftr[k,j,1],j],5,1]>0){if(lager[mat[zuord[auftr[k,j,1],j],5,1],2] < 10*mat[zuord[auftr[k,j,1],j],5,2]){next}}
         #Material buchen
         for(l in 1:5){
           if(mat[zuord[auftr[k,j,1],j],l,1]==0){next}
           lager[mat[zuord[auftr[k,j,1],j],l,1],2] <- lager[mat[zuord[auftr[k,j,1],j],l,1],2] - 10*mat[zuord[auftr[k,j,1],j],l,2]
         }
         
         
         
         #Rüsten
         if(zust[1,j]!=zuord[auftr[k,j,1],j] && rüstz[auftr[k,j,1],j]>0){
          zust[3,j] <- rüstz[auftr[k,j,1],j]-1
          zust[7,j] <- zust[7,j]+1
         #nicht Rüsten(entweder Rüstzeit 0 oder schon gerüstet)
         }else{
           zust[2,j] <- 10*bearz[auftr[k,j,1],j]-1
         }
         zust[1,j] <- zuord[auftr[k,j,1],j]
         zust[5,j] <- k
         zust[6,j] <- auftr[k,j,1]
         beleg[i,j] <- zust[6,j]
         break
       }
      }
    #nicht frei  
    }else{
     #es wird bearbeitet
     if(zust[2,j]>0){
       beleg[i,j] <- zust[6,j]
       zust[2,j]<-zust[2,j]-1
       if(zust[2,j]==0){
         zwischenlager[zust[1,j],2] <- zwischenlager[zust[1,j],2] + 10
         auftr[zust[5,j],j,2] <- auftr[zust[5,j],j,2] - 10
       }
      #es wird gerüstet
     }else{
       beleg[i,j] <- zust[6,j]
       zust[3,j]<-zust[3,j]-1
       if(zust[3,j]==0){
         zust[2,j] <- 10*bearz[zust[6,j],j]
       }
     } 
    }
   if(j==15){lager[1:100,2] <- (zwischenlager[1:100,2] + lager[1:100,2])} 
  }
  
  ergi. <- list(auftr,zust,lager,beleg)
  return(ergi.)
}

# ----- Define a function for plotting a matrix ----- #
myImagePlot <- function(x, ...){
  #use windows(height=4,width=8) instead of quartz(height=4,width=8) on a pc
  quartz(height=4,width=8)
  min <- 0
  max <- 56
  yLabels <- rownames(x)
  xLabels <- colnames(x)
  title <-c()
  # check for additional function arguments
  if( length(list(...)) ){
    Lst <- list(...)
    if( !is.null(Lst$zlim) ){
      min <- Lst$zlim[1]
      max <- Lst$zlim[2]
    }
    if( !is.null(Lst$yLabels) ){
      yLabels <- c(Lst$yLabels)
    }
    if( !is.null(Lst$xLabels) ){
      xLabels <- c(Lst$xLabels)
    }
    if( !is.null(Lst$title) ){
      title <- Lst$title
    }
  }
  # check for null values
  if( is.null(xLabels) ){
    xLabels <- c(1:ncol(x))
  }
  if( is.null(yLabels) ){
    yLabels <- c(1:nrow(x))
  }
  
  # Reverse Y axis
  reverse <- ncol(x) : 1
  xLabels <- xLabels[reverse]
  x <- x[,reverse]
  
  layout(matrix(data=c(1,2), nrow=1, ncol=2), widths=c(4,1), heights=c(1,1))
  
  # Color
  ColorRamp <- c("#FFFAFA", "#FFEFD5", "#FFEFD5", "#FFEFD5", "#FFEFD5", "#FFEFD5", 
                 "#CD0000", "#CD0000", "#CD0000", "#CD0000", "#0000CD", "#0000CD", 
                 "#0000CD", "#0000CD", "#0000CD", "#008B00", "#008B00", "#008B00", 
                 "#008B00", "#CD8500", "#CD8500", "#CD8500", "#CD8500", "#1717E8", 
                 "#698B22", "#698B22", "#698B22", "#698B22", "#EE9A00", "#EE9A00", 
                 "#EE9A00", "#EE9A00", "#2E8B57", "#2E8B57", "#2E8B57", "#2E8B57", 
                 "#2E8B57", "#EEC900", "#EEC900", "#EEC900", "#EEC900", "#EEC900", 
                 "#228B22", "#228B22", "#228B22", "#228B22", "#CD853F", "#CD853F", 
                 "#CD853F", "#CD853F", "#CD853F", "#458B00", "#458B00", "#458B00", 
                 "#458B00", "#FF8C00", "#FF8C00", "#FF8C00", "#FF8C00", "#FF8C00", 
                 "#3CB371", "#3CB371", "#3CB371", "#3CB371", "#CDAD00", "#CDAD00", 
                 "#CDAD00", "#CDAD00", "#CDAD00", "#EEE8AA", "#EEE8AA", "#EEE8AA", 
                 "#EEE8AA", "#EEE8AA", "#FF0000", "#FF0000", "#FF0000", "#FF0000", 
                 "#3A5FCD", "#3A5FCD", "#3A5FCD", "#3A5FCD", "#3A5FCD", "#EEEE00", 
                 "#EEEE00", "#EEEE00", "#EEEE00", "#EE1289", "#EE1289", "#EE1289", 
                 "#EE1289", "#EE1289", "#9A32CD", "#9A32CD", "#9A32CD", "#9A32CD", 
                 "#9A32CD", "#9A32CD", "#9A32CD", "#9A32CD", "#9A32CD", "#9A32CD", 
                 "#9A32CD", "#9A32CD", "#9A32CD", "#9A32CD", "#9A32CD", "#9A32CD", 
                 "#9A32CD", "#9A32CD", "#9A32CD", "#9A32CD", "#9A32CD", "#9A32CD", 
                 "#9A32CD", "#9A32CD", "#9A32CD", "#9A32CD", "#9A32CD", "#EEDC82", 
                 "#EEDC82", "#EEDC82", "#EEDC82", "#EEDC82", "#EEDC82", "#EEDC82", 
                 "#EEDC82", "#EEDC82", "#EEDC82", "#EEDC82", "#EEDC82", "#EEDC82", 
                 "#EEDC82", "#FF3030", "#FF3030", "#FF3030", "#FF3030", "#FF3030", 
                 "#8968CD", "#8968CD", "#8968CD", "#8968CD", "#8E8E71", "#8F8F70", 
                 "#90906F", "#91916E", "#92926D", "#93936C", "#94946B", "#95956A", 
                 "#969669", "#979768", "#989867", "#999966", "#9A9A65", "#9B9B64", 
                 "#9C9C63", "#9D9D62", "#9E9E61", "#9F9F60", "#A0A05F", "#A1A15E", 
                 "#A2A25D", "#A3A35C", "#A4A45B", "#A5A55A", "#A6A659", "#A7A758", 
                 "#A8A857", "#A9A956", "#AAAA55", "#ABAB54", "#ACAC53", "#ADAD52", 
                 "#AEAE51", "#AFAF50", "#B0B04F", "#B1B14E", "#B2B24D", "#B3B34C", 
                 "#B4B44B", "#B5B54A", "#B6B649", "#B7B748", "#B8B847", "#B9B946", 
                 "#BABA45", "#BBBB44", "#BCBC43", "#BDBD42", "#BEBE41", "#BFBF40", 
                 "#C0C03F", "#C1C13E", "#C2C23D", "#C3C33C", "#C4C43B", "#C5C53A", 
                 "#C6C639", "#C7C738", "#C8C837", "#C9C936", "#CACA35", "#CBCB34", 
                 "#CCCC33", "#CDCD32", "#CECE31", "#CFCF30", "#D0D02F", "#D1D12E", 
                 "#D2D22D", "#D3D32C", "#D4D42B", "#D5D52A", "#D6D629", "#D7D728", 
                 "#D8D827", "#D9D926", "#DADA25", "#DBDB24", "#DCDC23", "#DDDD22", 
                 "#DEDE21", "#FFFF00", "#FFFF00", "#FFFF00", "#FFFF00", "#FFFF00", 
                 "#FF1493", "#FF1493", "#FF1493", "#FF1493", "#FF1493", "#B23AEE", 
                 "#B23AEE", "#B23AEE", "#B23AEE", "#B23AEE", "#B23AEE", "#B23AEE", 
                 "#B23AEE", "#B23AEE", "#B23AEE", "#B23AEE", "#B23AEE", "#B23AEE", 
                 "#FDF5E6", "#FDF5E6", "#FDF5E6", "#FDF5E6", "#FDF5E6", "#B22222", 
                 "#B22222", "#B22222", "#B22222", "#0000FF")
  
  # Data Map
  par(mar = c(3,5,2.5,2))
  image(1:length(yLabels), 1:length(xLabels), x, col=ColorRamp, xlab="",
        ylab="", axes=FALSE, zlim=c(min,max))
  if( !is.null(title) ){
    title(main=title)
  }
  axis(BELOW<-1, at=seq(0, length(yLabels), by = 60), labels=seq(0, length(yLabels), by = 60), cex.axis=0.7, lwd=0)
  axis(LEFT <-2, at=1:length(xLabels), labels=xLabels, las= HORIZONTAL<-1,
       cex.axis=0.7)
  abline(v=seq(0, length(yLabels), by = 60),lty=2)
  
  # Color Scale
  
  legende <- 1:31
  lLabels <- c("free",1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,26,29,30,31,49,50,51,54,55,56)
  
  ColorRamp2 <- c("#FFFAFA", "#FFEFD5", "#CD0000", "#0000CD", "#008B00", "#CD8500", 
                  "#698B22", "#EE9A00", "#2E8B57", "#EEC900", "#228B22", "#CD853F", 
                  "#458B00", "#FF8C00", "#3CB371", "#CDAD00", "#EEE8AA", "#FF0000", 
                  "#3A5FCD", "#EEEE00", "#EE1289", "#9A32CD", "#EEDC82", "#FF3030", 
                  "#8968CD", "#FFFF00", "#FF1493", "#B23AEE", "#FDF5E6", "#B22222", 
                  "#0000FF")
  
  par(mar = c(3,2.5,2.5,2))
  image(1, legende,
        matrix(data=legende, ncol=length(legende),nrow=1),
        col=ColorRamp2,
        xlab="",ylab="",
        xaxt="n",
        axes=FALSE)
  axis(LEFT <-2, at=1:length(lLabels), labels=lLabels, las= HORIZONTAL<-1,
       cex.axis=0.7)
  
  layout(1)
  
}


erg. <- simulation(prod,lager,über,auftr,zust)

#Ergebnisse
auftr     <- array(c(matrix(unlist(erg.[1]))),dim=c(30,15,2))
zust     <- matrix((c(unlist(erg.[2]))),7,15)
lager    <- matrix((c(unlist(erg.[3]))),100,3)
beleg1    <- matrix((c(unlist(erg.[4]))),(480+max(über)),15)
beleg2    <- matrix((c(unlist(erg.[5]))),(480+max(über)),15)
beleg3    <- matrix((c(unlist(erg.[6]))),(480+max(über)),15)
beleg4    <- matrix((c(unlist(erg.[7]))),(480+max(über)),15)
beleg5    <- matrix((c(unlist(erg.[8]))),(480+max(über)),15)
über <- matrix((c(unlist(erg.[9]))),1,15)

#Aufbereitung der Ergebnisse
Auslastung <- 1-(sum(zust[4,])/(5*14*480+5*sum(über)))
Leerminuten <- sum(zust[4,])

WartendeAufträge <- matrix(0,3,100)
k <- 1
for(j in 1:15){
  for(i in 1:30){
    if(auftr[i,j,2]!=0){
      WartendeAufträge[1,k] <- j
      WartendeAufträge[2,k] <- auftr[i,j,1]
      WartendeAufträge[3,k] <- auftr[i,j,2]
      k <- k + 1
    }
  }
}



WartendeAufträge <- WartendeAufträge[ , !apply(WartendeAufträge==0,2,all)]

Rüstvorgänge <- matrix(zust[7,],1,15)
Rüstvorgänge <- t(Rüstvorgänge)

lager[1,2] <- lager[1,2]-vert[1]
lager[2,2] <- lager[2,2]-vert[2]
lager[3,2] <- lager[3,2]-vert[3]
LagerwertohneBestellungen <- sum(lager[,2]*lager[,3])

dev.off(which = 2)
dev.off(which = 3)
dev.off(which = 4)
dev.off(which = 5)
dev.off(which = 6)
myImagePlot(beleg5, title="Tag 5")
myImagePlot(beleg4, title="Tag 4")
myImagePlot(beleg3, title="Tag 3")
myImagePlot(beleg2, title="Tag 2")
myImagePlot(beleg1, title="Tag 1")

cat(rep("\n", 50))

Auslastung
Leerminuten
WartendeAufträge
Rüstvorgänge
LagerwertohneBestellungen
